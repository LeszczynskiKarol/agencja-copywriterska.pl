---
// src/pages/kontakt/index.astro
import BaseLayout from '../../layouts/BaseLayout.astro';
import SectionHeading from '../../components/SectionHeading.astro';

// ============================================
// KONFIGURACJA - zmień na swoje wartości
// ============================================
const API_URL = 'https://5k8tlw15vb.execute-api.eu-north-1.amazonaws.com';
// ============================================

const contactMethods = [
  {
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>`,
    title: 'Telefon',
    value: '+48 509 370 772',
    href: 'tel:+48509370772',
    detail: 'Pon–Pt: 9:00–17:00'
  },
  {
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>`,
    title: 'Email',
    value: 'kontakt@agencja-copywriterska.pl',
    href: 'mailto:kontakt@agencja-copywriterska.pl',
    detail: 'Odpowiedź w 24 godz.'
  },
  {
    icon: `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>`,
    title: 'Lokalizacja',
    value: 'Toruń / Bydgoszcz',
    href: 'https://maps.google.com/?q=Toruń',
    detail: 'Cała Polska online'
  }
];

const formServices = [
  'Copywriting / teksty sprzedażowe',
  'Pisanie artykułów blogowych',
  'Opisy produktów / kategorii',
  'Tworzenie ebooka / publikacji',
  'Skład tekstu LaTeX',
  'Artykuły sponsorowane',
  'Naming / branding',
  'Inne'
];

// Schema.org
const contactSchema = {
  "@context": "https://schema.org",
  "@type": "ContactPage",
  "name": "Kontakt - Agencja Copywriterska",
  "url": "https://agencja-copywriterska.pl/kontakt",
  "mainEntity": {
    "@type": "Organization",
    "name": "Agencja Copywriterska",
    "telephone": "+48509370772",
    "email": "kontakt@agencja-copywriterska.pl",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Toruń",
      "addressCountry": "PL"
    }
  }
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Strona główna", "item": "https://agencja-copywriterska.pl" },
    { "@type": "ListItem", "position": 2, "name": "Kontakt", "item": "https://agencja-copywriterska.pl/kontakt" }
  ]
};
---

<BaseLayout
  title="Kontakt | Agencja Copywriterska - Darmowa wycena w 24 godz."
  description="Skontaktuj się z nami i zamów profesjonalne teksty. Darmowa wycena w 24 godz.. Tel: +48 509 370 772, email: kontakt@agencja-copywriterska.pl"
>
  <script type="application/ld+json" set:html={JSON.stringify(contactSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />

  <!-- Breadcrumbs -->
  <nav class="breadcrumbs" aria-label="Breadcrumb">
    <div class="container">
      <ol class="breadcrumbs__list">
        <li><a href="/">Strona główna</a></li>
        <li aria-current="page">Kontakt</li>
      </ol>
    </div>
  </nav>

  <!-- Hero -->
  <section class="contact-hero">
    <div class="contact-hero__bg">
      <div class="contact-hero__pattern"></div>
    </div>
    <div class="container">
      <div class="contact-hero__content">
        <span class="badge badge-accent">
          <span class="badge-dot"></span>
          Bezpłatna wycena
        </span>
        <h1 class="contact-hero__title">
          Porozmawiajmy o <span class="text-gradient">Twoim projekcie</span>
        </h1>
        <p class="contact-hero__subtitle lead">
          Opisz, czego potrzebujesz – przygotujemy indywidualną wycenę w ciągu 24 godzin. 
          Bez zobowiązań, bez ukrytych kosztów.
        </p>
      </div>
    </div>
  </section>

  <!-- Contact Methods -->
  <section class="contact-methods-section">
    <div class="container">
      <div class="contact-methods-grid">
        {contactMethods.map((method) => (
          <a href={method.href} class="contact-method-card" target={method.href.startsWith('http') ? '_blank' : undefined}>
            <div class="contact-method-card__icon" set:html={method.icon} />
            <div class="contact-method-card__body">
              <span class="contact-method-card__label">{method.title}</span>
              <strong class="contact-method-card__value">{method.value}</strong>
              <span class="contact-method-card__detail">{method.detail}</span>
            </div>
          </a>
        ))}
      </div>
    </div>
  </section>

  <!-- Contact Form Section -->
  <section class="contact-form-section" id="formularz">
    <div class="container">
      <div class="contact-grid">
        <!-- Form -->
        <div class="contact-form-wrapper">
          <div class="contact-form-card">
            <h2 class="contact-form-card__title">Wyślij zapytanie</h2>
            <p class="contact-form-card__subtitle">Pola oznaczone * są wymagane</p>

            <form class="contact-form" id="contactForm" novalidate>
              <div class="form-row">
                <div class="form-group">
                  <label for="cf-name">Imię *</label>
                  <input type="text" id="cf-name" name="name" required placeholder="Jan Kowalski" autocomplete="name" />
                </div>
                <div class="form-group">
                  <label for="cf-company">Firma (opcjonalnie)</label>
                  <input type="text" id="cf-company" name="company" placeholder="Nazwa firmy" autocomplete="organization" />
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="cf-email">Email *</label>
                  <input type="email" id="cf-email" name="email" required placeholder="jan@example.com" autocomplete="email" />
                </div>
                <div class="form-group">
                  <label for="cf-phone">Telefon (opcjonalnie)</label>
                  <input type="tel" id="cf-phone" name="phone" placeholder="+48 123 456 789" autocomplete="tel" />
                </div>
              </div>

              <div class="form-group">
                <label for="cf-service">Rodzaj usługi (opcjonalnie)</label>
                <select id="cf-service" name="service">
                  <option value="">Wybierz usługę</option>
                  {formServices.map(s => (
                    <option value={s}>{s}</option>
                  ))}
                </select>
              </div>

              <div class="form-group">
                <label for="cf-message">Opis projektu *</label>
                <textarea 
                  id="cf-message" 
                  name="message" 
                  rows="6" 
                  required 
                  placeholder="Opisz swój projekt, oczekiwania, termin realizacji..."
                ></textarea>
              </div>

              <!-- File Upload -->
              <div class="form-group">
                <label>Załączniki <span class="form-hint">(maks. 5 plików, do 10 MB każdy)</span></label>
                <div class="file-upload" id="fileUpload">
                  <div class="file-upload__dropzone" id="dropzone">
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p>Przeciągnij pliki tutaj lub <button type="button" class="file-upload__browse" id="browseBtn">wybierz z dysku</button></p>
                    <span class="file-upload__formats">PDF, DOC, DOCX, JPG, PNG, ZIP</span>
                  </div>
                  <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.zip,.rar,.xlsx,.txt" class="sr-only" />
                  <ul class="file-upload__list" id="fileList"></ul>
                </div>
              </div>

              <!-- Consent -->
              <div class="form-group">
                <label class="checkbox-label">
                  <input type="checkbox" name="consent" required />
                  <span>Wyrażam zgodę na przetwarzanie danych osobowych w celu odpowiedzi na zapytanie. *</span>
                </label>
              </div>

              <!-- Status -->
              <div class="form-status" id="formStatus" hidden></div>

              <!-- Submit -->
              <button type="submit" class="btn btn-primary btn-lg form-submit" id="submitBtn">
                <span class="form-submit__text">Wyślij zapytanie</span>
                <span class="form-submit__loading" hidden>
                  <svg class="spinner" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="31.4 31.4" stroke-linecap="round"/></svg>
                  Wysyłanie...
                </span>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
              </button>
            </form>
          </div>
        </div>

        <!-- Sidebar -->
        <aside class="contact-sidebar">
          <!-- Quick info -->
          <div class="sidebar-card sidebar-card--dark">
            <h3>Jak wygląda współpraca?</h3>
            <ol class="sidebar-steps">
              <li>
                <span class="sidebar-steps__num">1</span>
                <div>
                  <strong>Wysyłasz zapytanie</strong>
                  <p>Opisz projekt — im więcej szczegółów, tym lepsza wycena.</p>
                </div>
              </li>
              <li>
                <span class="sidebar-steps__num">2</span>
                <div>
                  <strong>Wycena w 24 godz.</strong>
                  <p>Otrzymasz szczegółową ofertę z terminem realizacji.</p>
                </div>
              </li>
              <li>
                <span class="sidebar-steps__num">3</span>
                <div>
                  <strong>Realizacja</strong>
                  <p>Po akceptacji przystępuję do pracy. Poprawki w cenie.</p>
                </div>
              </li>
            </ol>
          </div>

          <!-- Trust signals -->
          <div class="sidebar-card">
            <h3>Dlaczego warto?</h3>
            <ul class="sidebar-benefits">
              <li>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                Wycena bez zobowiązań
              </li>
              <li>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                15+ lat doświadczenia
              </li>
              <li>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                5000+ napisanych tekstów
              </li>
              
              <li>
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>
                Poprawki w cenie
              </li>
            </ul>
          </div>

          <!-- Business data -->
          <div class="sidebar-card">
            <h3>Dane firmy</h3>
            <div class="sidebar-biz">
              <div><span>NIP:</span> 9562203948</div>
              <div><span>Adres:</span> Toruń, Polska</div>
              <div><span>Email:</span> kontakt@agencja-copywriterska.pl</div>
              <div><span>Tel:</span> +48 509 370 772</div>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <!-- FAQ 
  <section class="contact-faq">
    <div class="container container-narrow">
      <SectionHeading
        label="FAQ"
        title="Często zadawane <span class='accent'>pytania</span>"
        align="center"
      />
      <div class="faq-list">
        <details class="faq-item">
          <summary>Ile kosztują Wasze usługi?</summary>
          <p>Ceny zależą od rodzaju i objętości tekstu. Artykuł blogowy zaczyna się od 300 zł, opisy produktów od 30 zł/szt., a ebooki od 2000 zł. Wyślij zapytanie — przygotujemy indywidualną wycenę.</p>
        </details>
        <details class="faq-item">
          <summary>Jaki jest czas realizacji?</summary>
          <p>Standardowy artykuł to 3-5 dni roboczych. Większe projekty (ebooki, podręczniki) to 2-6 tygodni. Konkretny termin zawsze ustalamy przed rozpoczęciem pracy.</p>
        </details>
        <details class="faq-item">
          <summary>Czy mogę liczyć na poprawki?</summary>
          <p>Tak, poprawki i korekty są wliczone w cenę. Zależy nam na Twoim zadowoleniu z efektu końcowego.</p>
        </details>
        <details class="faq-item">
          <summary>Czy wystawiacie fakturę VAT?</summary>
          <p>Tak, do każdego zlecenia wystawiamy fakturę VAT.</p>
        </details>
        <details class="faq-item">
          <summary>Czy mogę dołączyć materiały do zapytania?</summary>
          <p>Oczywiście — formularz pozwala na załączenie plików (PDF, DOC, grafiki). Możesz też wysłać materiały mailem po złożeniu zapytania.</p>
        </details>
      </div>
    </div>
  </section>-->
</BaseLayout>

<style>
  /* Breadcrumbs */
  .breadcrumbs {
    padding: var(--space-4) 0;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border-color);
  }
  .breadcrumbs__list {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    list-style: none;
    padding: 0;
    margin: 0;
    font-size: var(--fs-sm);
  }
  .breadcrumbs__list li {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }
  .breadcrumbs__list li:not(:last-child)::after {
    content: "/";
    color: var(--text-tertiary);
  }
  .breadcrumbs__list a {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s;
  }
  .breadcrumbs__list a:hover {
    color: var(--color-accent);
  }
  .breadcrumbs__list li[aria-current="page"] {
    color: var(--text-primary);
    font-weight: 500;
  }

  /* Hero */
  .contact-hero {
    position: relative;
    padding: var(--space-20) 0 var(--space-12);
    text-align: center;
    overflow: hidden;
  }
  .contact-hero__bg {
    position: absolute;
    inset: 0;
    z-index: -1;
    background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
  }
  .contact-hero__pattern {
    position: absolute;
    inset: 0;
    background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
    background-size: 30px 30px;
    opacity: 0.4;
  }
  .contact-hero__content {
    max-width: 700px;
    margin: 0 auto;
  }
  .contact-hero__title {
    font-family: var(--font-display);
    font-size: clamp(2rem, 4vw, 3.2rem);
    font-weight: 700;
    line-height: 1.15;
    margin-bottom: var(--space-6);
  }
  .contact-hero__subtitle {
    max-width: 560px;
    margin: 0 auto;
  }

  /* Contact Methods */
  .contact-methods-section {
    padding: var(--space-12) 0;
    margin-top: calc(var(--space-8) * -1);
    position: relative;
    z-index: 10;
  }
  .contact-methods-grid {
    display: grid;
    gap: var(--space-6);
    grid-template-columns: repeat(3, 1fr);
  }
  @media (max-width: 768px) {
    .contact-methods-grid { grid-template-columns: 1fr; }
  }
  .contact-method-card {
    display: flex;
    align-items: center;
    gap: var(--space-5);
    padding: var(--space-6);
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-md);
    text-decoration: none;
    transition: all 0.25s ease;
  }
  .contact-method-card:hover {
    border-color: var(--color-accent);
    transform: translateY(-3px);
    box-shadow: var(--shadow-lg);
  }
  .contact-method-card__icon {
    width: 52px;
    height: 52px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, var(--color-primary) 0%, #1a2248 100%);
    border-radius: var(--radius-lg);
    color: var(--color-accent);
    flex-shrink: 0;
  }
  .contact-method-card__label {
    font-size: var(--fs-xs);
    color: var(--text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-weight: 600;
  }
  .contact-method-card__value {
    display: block;
    font-family: var(--font-display);
    font-size: var(--fs-lg);
    color: var(--text-primary);
    margin: var(--space-1) 0;
  }
  .contact-method-card__detail {
    font-size: var(--fs-sm);
    color: var(--text-tertiary);
  }

  /* Contact Grid (Form + Sidebar) */
  .contact-form-section {
    padding: var(--space-16) 0 var(--space-20);
    background: var(--bg-secondary);
  }
  .contact-grid {
    display: grid;
    gap: var(--space-10);
    grid-template-columns: 1.4fr 1fr;
    align-items: start;
  }
  @media (max-width: 1024px) {
    .contact-grid { grid-template-columns: 1fr; }
  }

  /* Form Card */
  .contact-form-card {
    padding: var(--space-10);
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
  }
  .contact-form-card__title {
    font-family: var(--font-display);
    font-size: var(--fs-2xl);
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: var(--space-2);
  }
  .contact-form-card__subtitle {
    font-size: var(--fs-sm);
    color: var(--text-tertiary);
    margin-bottom: var(--space-8);
  }

  /* Form elements */
  .contact-form {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
  }
  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-5);
  }
  @media (max-width: 640px) {
    .form-row { grid-template-columns: 1fr; }
  }
  .form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }
  .form-group label {
    font-size: var(--fs-sm);
    font-weight: 600;
    color: var(--text-primary);
  }
  .form-hint {
    font-weight: 400;
    color: var(--text-tertiary);
  }
  .form-group input,
  .form-group select,
  .form-group textarea {
    padding: var(--space-3) var(--space-4);
    font-size: var(--fs-base);
    font-family: var(--font-body);
    color: var(--text-primary);
    background: var(--bg-secondary);
    border: 2px solid var(--border-color);
    border-radius: var(--radius-lg);
    transition: all 0.2s ease;
  }
  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px rgba(252, 187, 66, 0.15);
    background: var(--bg-primary);
  }
  .form-group input.error,
  .form-group select.error,
  .form-group textarea.error {
    border-color: #e53e3e;
  }
  .form-group textarea {
    resize: vertical;
    min-height: 130px;
  }
  .form-group select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7194' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 1rem center;
    padding-right: 2.5rem;
  }

  /* Checkbox */
  .checkbox-label {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    cursor: pointer;
    font-size: var(--fs-sm);
    color: var(--text-secondary);
    line-height: 1.5;
  }
  .checkbox-label input[type="checkbox"] {
    width: 18px;
    height: 18px;
    margin-top: 2px;
    flex-shrink: 0;
    cursor: pointer;
    accent-color: var(--color-accent);
  }

  /* File Upload */
  .file-upload__dropzone {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-8);
    border: 2px dashed var(--border-color);
    border-radius: var(--radius-lg);
    background: var(--bg-secondary);
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--text-tertiary);
  }
  .file-upload__dropzone:hover,
  .file-upload__dropzone.dragover {
    border-color: var(--color-accent);
    background: rgba(252, 187, 66, 0.05);
    color: var(--color-accent);
  }
  .file-upload__dropzone p {
    font-size: var(--fs-sm);
    color: var(--text-secondary);
    margin: 0;
  }
  .file-upload__browse {
    color: var(--color-accent);
    font-weight: 600;
    text-decoration: underline;
    background: none;
    border: none;
    cursor: pointer;
    font-size: inherit;
    font-family: inherit;
    padding: 0;
  }
  .file-upload__formats {
    font-size: var(--fs-xs);
    color: var(--text-tertiary);
  }
  .file-upload__list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    margin-top: var(--space-3);
  }
  .file-upload__item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-3) var(--space-4);
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-md);
    font-size: var(--fs-sm);
  }
  .file-upload__item-info {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    min-width: 0;
  }
  .file-upload__item-name {
    color: var(--text-primary);
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .file-upload__item-size {
    color: var(--text-tertiary);
    white-space: nowrap;
  }
  .file-upload__item-remove {
    background: none;
    border: none;
    color: var(--text-tertiary);
    cursor: pointer;
    padding: var(--space-1);
    border-radius: var(--radius-sm);
    transition: all 0.15s;
    flex-shrink: 0;
  }
  .file-upload__item-remove:hover {
    color: #e53e3e;
    background: rgba(229, 62, 62, 0.1);
  }
  .file-upload__item-progress {
    height: 3px;
    background: var(--border-color);
    border-radius: 2px;
    overflow: hidden;
    margin-top: var(--space-2);
  }
  .file-upload__item-progress-bar {
    height: 100%;
    background: var(--color-accent);
    transition: width 0.3s ease;
    border-radius: 2px;
  }

  /* Form Status */
  .form-status {
    padding: var(--space-4) var(--space-5);
    border-radius: var(--radius-lg);
    font-size: var(--fs-sm);
    font-weight: 500;
  }
  .form-status.success {
    background: rgba(56, 161, 105, 0.1);
    color: #2f855a;
    border: 1px solid rgba(56, 161, 105, 0.3);
  }
  .form-status.error {
    background: rgba(229, 62, 62, 0.1);
    color: #c53030;
    border: 1px solid rgba(229, 62, 62, 0.3);
  }

  /* Submit button */
  .form-submit {
    width: 100%;
    gap: var(--space-3);
  }
  .form-submit[disabled] {
    opacity: 0.7;
    cursor: not-allowed;
  }
  .spinner {
    width: 20px;
    height: 20px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Sidebar */
  .contact-sidebar {
    display: flex;
    flex-direction: column;
    gap: var(--space-6);
    position: sticky;
    top: 100px;
  }
  .sidebar-card {
    padding: var(--space-8);
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-xl);
  }
  .sidebar-card h3 {
    font-family: var(--font-display);
    font-size: var(--fs-lg);
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: var(--space-5);
  }
  .sidebar-card--dark {
    background: linear-gradient(135deg, var(--color-primary) 0%, #1a2248 100%);
    border-color: transparent;
    color: white;
  }
  .sidebar-card--dark h3 { color: white; }
  .sidebar-card--dark p { color: rgba(255,255,255,0.7); }

  /* Sidebar Steps */
  .sidebar-steps {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
    counter-reset: none;
  }
  .sidebar-steps li {
    display: flex;
    gap: var(--space-4);
  }
  .sidebar-steps__num {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-accent);
    color: var(--color-primary);
    font-family: var(--font-display);
    font-weight: 700;
    font-size: var(--fs-sm);
    border-radius: var(--radius-full);
    flex-shrink: 0;
  }
  .sidebar-steps li strong {
    display: block;
    color: white;
    font-size: var(--fs-sm);
    margin-bottom: var(--space-1);
  }
  .sidebar-steps li p {
    font-size: var(--fs-xs);
    margin: 0;
  }

  /* Sidebar Benefits */
  .sidebar-benefits {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
  }
  .sidebar-benefits li {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    font-size: var(--fs-sm);
    color: var(--text-secondary);
  }
  .sidebar-benefits svg {
    color: var(--color-accent);
    flex-shrink: 0;
  }

  /* Sidebar Biz */
  .sidebar-biz {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    font-size: var(--fs-sm);
    color: var(--text-secondary);
  }
  .sidebar-biz span {
    font-weight: 600;
    color: var(--text-primary);
  }

  /* FAQ */
  .contact-faq {
    padding: var(--space-20) 0;
    background: var(--bg-primary);
  }
  .faq-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    margin-top: var(--space-10);
  }
  .faq-item {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-lg);
    overflow: hidden;
    transition: all 0.2s ease;
  }
  .faq-item[open] {
    border-color: var(--color-accent);
    box-shadow: var(--shadow-md);
  }
  .faq-item summary {
    padding: var(--space-5) var(--space-6);
    font-family: var(--font-display);
    font-weight: 600;
    font-size: var(--fs-base);
    color: var(--text-primary);
    cursor: pointer;
    list-style: none;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: color 0.2s;
  }
  .faq-item summary:hover { color: var(--color-accent); }
  .faq-item summary::after {
    content: '+';
    font-size: var(--fs-xl);
    color: var(--color-accent);
    font-weight: 300;
    transition: transform 0.2s;
  }
  .faq-item[open] summary::after { transform: rotate(45deg); }
  .faq-item summary::-webkit-details-marker { display: none; }
  .faq-item p {
    padding: 0 var(--space-6) var(--space-5);
    font-size: var(--fs-sm);
    color: var(--text-secondary);
    line-height: 1.7;
  }
</style>

<script define:vars={{ API_URL }}>
  // ============================================
  // CONTACT FORM with S3 PRESIGNED UPLOAD
  // ============================================

  const MAX_FILES = 5;
  const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10 MB
  const ALLOWED_TYPES = [
    'application/pdf', 'application/msword',
    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
    'image/jpeg', 'image/png',
    'application/zip', 'application/x-rar-compressed',
    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    'text/plain'
  ];

  let selectedFiles = [];
  let uploadedKeys = [];

  const form = document.getElementById('contactForm');
  const fileInput = document.getElementById('fileInput');
  const browseBtn = document.getElementById('browseBtn');
  const dropzone = document.getElementById('dropzone');
  const fileList = document.getElementById('fileList');
  const submitBtn = document.getElementById('submitBtn');
  const formStatus = document.getElementById('formStatus');

  // --- File handling ---
  browseBtn.addEventListener('click', () => fileInput.click());
  dropzone.addEventListener('click', (e) => {
    if (e.target === dropzone || e.target.closest('.file-upload__dropzone')) {
      fileInput.click();
    }
  });

  // Drag & Drop
  ['dragenter', 'dragover'].forEach(evt => {
    dropzone.addEventListener(evt, (e) => { e.preventDefault(); dropzone.classList.add('dragover'); });
  });
  ['dragleave', 'drop'].forEach(evt => {
    dropzone.addEventListener(evt, (e) => { e.preventDefault(); dropzone.classList.remove('dragover'); });
  });
  dropzone.addEventListener('drop', (e) => {
    const files = Array.from(e.dataTransfer.files);
    addFiles(files);
  });

  fileInput.addEventListener('change', () => {
    addFiles(Array.from(fileInput.files));
    fileInput.value = '';
  });

  function addFiles(files) {
    for (const file of files) {
      if (selectedFiles.length >= MAX_FILES) {
        showStatus('Maksymalnie ' + MAX_FILES + ' plików.', 'error');
        break;
      }
      if (file.size > MAX_FILE_SIZE) {
        showStatus('Plik "' + file.name + '" jest za duży (maks. 10 MB).', 'error');
        continue;
      }
      if (selectedFiles.some(f => f.name === file.name)) continue;
      selectedFiles.push(file);
    }
    renderFileList();
  }

  function removeFile(index) {
    selectedFiles.splice(index, 1);
    renderFileList();
  }

  function formatSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
  }

  function renderFileList() {
    fileList.innerHTML = '';
    selectedFiles.forEach((file, i) => {
      const li = document.createElement('li');
      li.className = 'file-upload__item';
      li.id = 'file-item-' + i;
      li.innerHTML = `
        <div class="file-upload__item-info">
          <span class="file-upload__item-name">${file.name}</span>
          <span class="file-upload__item-size">${formatSize(file.size)}</span>
        </div>
        <button type="button" class="file-upload__item-remove" data-index="${i}" title="Usuń">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        </button>
      `;
      li.querySelector('.file-upload__item-remove').addEventListener('click', () => removeFile(i));
      fileList.appendChild(li);
    });
  }

  // --- Upload file to S3 via presigned URL ---
  async function uploadFileToS3(file) {
    // 1. Get presigned URL
    const res = await fetch(API_URL + '/presign', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        filename: file.name,
        contentType: file.type || 'application/octet-stream',
        size: file.size
      })
    });
    if (!res.ok) throw new Error('Nie udało się uzyskać linku do uploadu');
    const { uploadUrl, key } = await res.json();

    // 2. Upload to S3
    const uploadRes = await fetch(uploadUrl, {
      method: 'PUT',
      headers: { 'Content-Type': file.type || 'application/octet-stream' },
      body: file
    });
    if (!uploadRes.ok) throw new Error('Nie udało się przesłać pliku: ' + file.name);

    return key;
  }

  // --- Form submission ---
  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    hideStatus();

    // Validation
    const name = form.querySelector('[name="name"]').value.trim();
    const email = form.querySelector('[name="email"]').value.trim();
    const service = form.querySelector('[name="service"]').value;
    const message = form.querySelector('[name="message"]').value.trim();
    const consent = form.querySelector('[name="consent"]').checked;

    if (!name || !email || !service || !message) {
      showStatus('Uzupełnij wszystkie wymagane pola.', 'error');
      return;
    }
    if (!consent) {
      showStatus('Wymagana jest zgoda na przetwarzanie danych.', 'error');
      return;
    }

    setLoading(true);

    try {
      // Upload attachments
      uploadedKeys = [];
      for (let i = 0; i < selectedFiles.length; i++) {
        const key = await uploadFileToS3(selectedFiles[i]);
        uploadedKeys.push({ key, name: selectedFiles[i].name, size: selectedFiles[i].size });
      }

      // Submit form
      const formData = {
        name,
        email,
        phone: form.querySelector('[name="phone"]').value.trim(),
        company: form.querySelector('[name="company"]').value.trim(),
        service,
        message,
        attachments: uploadedKeys
      };

      const res = await fetch(API_URL + '/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      if (!res.ok) {
        const err = await res.json().catch(() => ({}));
        throw new Error(err.error || 'Błąd serwera');
      }

      showStatus('Dziękujemy! Wiadomość została wysłana. Odpowiemy w ciągu 24 godzin.', 'success');
      form.reset();
      selectedFiles = [];
      uploadedKeys = [];
      renderFileList();

    } catch (err) {
      showStatus('Wystąpił błąd: ' + err.message + '. Spróbuj ponownie lub zadzwoń.', 'error');
    } finally {
      setLoading(false);
    }
  });

  function setLoading(loading) {
    submitBtn.disabled = loading;
    submitBtn.querySelector('.form-submit__text').hidden = loading;
    submitBtn.querySelector('.form-submit__loading').hidden = !loading;
    submitBtn.querySelector('svg:last-child').style.display = loading ? 'none' : '';
  }

  function showStatus(msg, type) {
    formStatus.hidden = false;
    formStatus.className = 'form-status ' + type;
    formStatus.textContent = msg;
    formStatus.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function hideStatus() {
    formStatus.hidden = true;
  }
</script>